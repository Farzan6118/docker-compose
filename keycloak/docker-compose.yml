services:
  # ----------postgres----------
  postgres_keycloak:
    container_name: postgres_keycloak
    environment:
      - POSTGRES_USER=${DEFAULT_USERNAME}
      - POSTGRES_PASSWORD=${DEFAULT_PASSWORD}
      - PGDATA=/data/postgres
    image: ${POSTGRES_IMAGE}
    ports:
      - 5432:5432
    restart: ${RESTART_MODE}
    volumes:
      - ./postgres_data:/data/postgres
  # ----------pgadmin---------
  pgadmin_keycloak:
    container_name: pgadmin_keycloak
    depends_on:
      - postgres_keycloak
    environment:
      - PGADMIN_DEFAULT_EMAIL=${DEFAULT_EMAIL}
      - PGADMIN_DEFAULT_PASSWORD=${DEFAULT_PASSWORD}
    image: ${PGADMIN_IMAGE}
    ports:
      - 5050:80
    restart: ${RESTART_MODE}
    volumes:
      - ./pgadmin_data:/data/pgadmin
# ----------- keycloak -------------
  keycloak:
    container_name: keycloak
    depends_on:
      - postgres_keycloak
    environment:
      - POSTGRES_USER=${DEFAULT_USERNAME}
      - POSTGRES_PASSWORD=${DEFAULT_PASSWORD}
      - PGADMIN_DEFAULT_EMAIL=${DEFAULT_EMAIL}
      - PGADMIN_DEFAULT_PASSWORD=${DEFAULT_PASSWORD}
    image: ${KEYCLOAK_IMAGE}
    networks:
      - backend
    restart: ${RESTART_MODE}
    ports:
      - 8180:8080
      - 8787:8787
# -- networks ----------------------
networks: 
  backend: 
    name: backend 
    driver: bridge